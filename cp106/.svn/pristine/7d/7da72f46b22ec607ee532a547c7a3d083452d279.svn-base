<template>
  <div class="lottery">
      <Fixmid></Fixmid>
      <TopNote></TopNote>
      <TopLoginReg></TopLoginReg>
      <TopTab :tabNum="5"></TopTab>
      <div class="lottery_wrap">
          <div class="lottery_cont" v-loading="loading2" style="min-height:200px;">
              <h3> <span @click="go_lottery"> 全部开奖 </span> <i>开奖历史</i> </h3>
              <table>
                  <thead>
                      <tr>
                          <th>彩种</th>
                          <th>期号</th>
                          <th>开奖号码</th>
                          <th>开奖时间</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr v-for="(items, indexs) in cp_data_list" :key="items.issue_number" v-if="($route.params.lot_type_id != 4 && $route.params.lot_type_id != 8 && $route.params.lot_type_id != 9 && $route.params.lot_type_id != 10 && $route.params.lot_type_id != 20 && $route.params.lot_type_id != 21 && $route.params.lot_type_id != 22 &&  $route.params.lot_type_id != 23  &&  $route.params.lot_type_id != 24)">
                          <td>{{ cp_title }}</td>
                          <td>第{{items.issue_number}}期</td>
                          <td>
                             <span style="margin-right:5px;" v-for="(item,index) in items.res"  :key="index * Math.random()"> {{item}} </span>
                          </td>
                          <td>
                            {{items.issue_date}}
                          </td>
                      </tr>

                       <tr v-for="(items, indexs) in cp_data_list" :key="items.issue_number" v-if="($route.params.lot_type_id == 4)">
                          <td>{{ cp_title }}</td>
                          <td>第{{items.issue_number}}期</td>
                          <td>
                             <span style="margin-right:5px;" v-for="(item,index) in items.res"  :key="index * Math.random()" v-if="(index <= 4 )"> {{item}} </span>
                             <span style="margin-right:5px;background:#0047aa;" v-for="(item,index) in items.res"  :key="index * Math.random()" v-if="(index > 4 )"> {{item}} </span>
                          </td>
                          <td>
                            {{items.issue_date}}
                          </td>
                      </tr>

                       <tr v-for="(items, indexs) in cp_data_list" :key="items.issue_number" v-if=" ($route.params.lot_type_id == 8 || $route.params.lot_type_id == 9  || $route.params.lot_type_id == 20 ) ">
                          <td>{{ cp_title }}</td>
                          <td>第{{items.issue_number}}期</td>
                          <td>
                             <div>
                                 <img :src="item | transImg" v-for="(item,index) in items.res" style="margin-right:5px;">
                             </div>
                          </td>
                          <td>
                            {{items.issue_date}}
                          </td>
                      </tr>

                       <tr v-for="(items, indexs) in cp_data_list" :key="items.issue_number" v-if="($route.params.lot_type_id == 10)">
                          <td>{{ cp_title }}</td>
                          <td>第{{items.issue_number}}期</td>
                          <td>
                             <span style="margin-right:5px;" v-for="(item,index) in items.res"  :key="index * Math.random()" v-if="(index <= 5 )"> {{item}} </span>
                             <span style="margin-right:5px;background:#0047aa;" v-for="(item,index) in items.res"  :key="index * Math.random()" v-if="(index > 5 )"> {{item}} </span>
                          </td>
                          <td>
                            {{items.issue_date}}
                          </td>
                      </tr>

                      <tr v-for="(items, indexs) in cp_data_list" :key="items.issue_number" v-if="($route.params.lot_type_id == 21 ||  $route.params.lot_type_id == 22)">
                          <td>{{ cp_title }}</td>
                          <td>第{{items.issue_number}}期</td>
                          <td>
                            <span v-for="(item,index) in items.res" v-if=" (index == 0 )"> {{ item }}  </span>
                                 + 
                            <span v-for="(item,index) in items.res" v-if=" (index == 1 )"> {{ item }}  </span>
                                 + 
                            <span v-for="(item,index) in items.res" v-if=" (index == 2 )"> {{ item }}  </span>
                                 = 
                            <span v-for="(item,index) in items.res" v-if="( index == 3 )">  {{ item }} </span>
                          </td>
                          <td>
                            {{items.issue_date}}
                          </td>
                      </tr>
                      
                      <tr v-for="(items, indexs) in cp_data_list" :key="indexs" v-if="($route.params.lot_type_id  == 23 )">
                          <td>{{ cp_title }}</td>
                          <td>第{{items.issue_number}}期</td>
                          <td>
                             <span style="margin-right:5px;" class="bo_se_span" v-for="(item,index) in items.res"  :key="index * Math.random()"> {{item}} </span>
                          </td>
                          <td>
                            {{items.issue_date}}
                          </td>
                      </tr>
                      <tr v-for="(items, indexs) in cp_data_list" :key="indexs" v-if="($route.params.lot_type_id  == 24 )">
                          <td>{{ cp_title }}</td>
                          <td>第{{items.issue_number}}期</td>
                          <td>
                             <span style="margin-right:5px;"  class="bo_se_span" v-for="(item,index) in items.res"   :key="index * Math.random()"> {{ item }}</span>
                          </td>
                          <td>
                            {{items.issue_date}}
                          </td>
                      </tr>
                      
                      <tr v-show="is_load_more" v-loading="loading3"> 
                          <td style="text-align:center;cursor:pointer;" @click="load_more">加载更多</td>
                      </tr>

                      <p v-show="is_load_more_text" style="text-align:center;margin-bottom:20px;">暂无更多数据</p>
                  </tbody>

              </table>
              <p @click="go_lottery" style="color:#0047aa;text-align:center;cursor:pointer;">全部开奖</p>
          </div>
      </div>
      <Qiandao></Qiandao>
      <BotCommon></BotCommon>
      <InfoPanel></InfoPanel>
      
  </div>
</template>

<script>

import TopLoginReg from '../topCommon/topLoginReg'
import TopTab from '../topCommon/topTab'
import TopNote from '../topCommon/topNote'
import Fixmid from '../common/fixmid'
import Qiandao from '../home/qiandao'
import  BotCommon from '../topCommon/botCommon'
import { messageBox , Loading } from 'element-ui';
import { requestOpt } from '../../api/recommend'
import InfoPanel from '../topCommon/infoPanel'
export default {
  name: 'Lottery',
  components:{
      TopLoginReg,
      TopTab,
      TopNote,
      Fixmid,
      BotCommon,
      Qiandao,
      InfoPanel
  },
  data () {
    return {
        cp_data_list : [],
        loading2:false,
        loading3 : false,
        cp_title:'',
        cur_page : 1,
        // page_num : 10,
        total_page : 1,
        is_load_more:true,
        is_load_more_text : false
    }
  },

  methods :{
        
        getData() {// 所有彩票列表集合
            // console.log(this.$route.params.lot_type_id);
            this.cp_title = sessionStorage.getItem('cp_title');
            requestOpt.reqnoGetpara('lottery_results/'+ this.$route.params.lot_type_id +'?page=' + this.cur_page,
            {
                // pag_num : this.page_num
            }, 
            (res)=>{
                this.cp_data_list = this.cp_data_list.concat(res.data.data.list);
                this.total_page = res.data.data.paging_arr.total_pages;
                if( this.total_page <= 1 ){
                    this.is_load_more = false;
                    this.is_load_more_text = true;
                }
                if(res.data.data.list.length < 1){
                    this.is_load_more_text = false;
                }
                setTimeout(() => {
                    this.define_bo_se('.bo_se_span');
                }, 60);

                 this.loading2 = false;
                 this.loading3 = false;
                }, (err)=>{
                    this.is_load_more_text = false;
                    if(err.data){
                           el_tip(err.data.msg)
                    }

                    this.loading2 = false;
                    this.loading3 = false;
                })
        },
        go_lottery(){
            this.$router.push('/lottery');
        },
        load_more(){
            this.loading3 = true;
            if(this.cur_page >= this.total_page){
                this.loading3 = false;
                // setTimeout(() => {
                //     this.define_bo_se('.bo_se_span');
                // }, 60);
                this.is_load_more = false;
                this.no_data_load();
                return;
            }
            this.cur_page++;
            // console.log(this.cur_page);
            this.getData();
        },
        no_data_load() {
            this.is_load_more = false;
            this.is_load_more_text = true;
        },
        define_bo_se(className){
            // if(this.$route.params.lot_type_id == 24){
            //     return;
            // }
            let  hong_bo = ['01', '02','07','08','12', '13' , '18' , '19' , '23' , '24' , '29' , '30' , '34' , '35' , '40' , '45' ,  '46'];
            let lan_bo =  ['03' ,'04' ,'09' ,'10' ,'14' ,'15' ,'20' ,'25' ,'26' ,'31' ,'36' ,'37' ,'41' ,'42' ,'47' ,'48' ];
            let lv_bo = ['05' ,  '06' ,  '11' ,  '16' ,  '17' ,  '21' ,  '22' ,  '27' ,  '28' ,  '32' ,  '33' ,  '38'  ,  '39' ,  '43' ,  '44' ,  '49']
            let $span_s = $(className);
            for(let i = 0; i < $span_s.length; i++){
                let text = $span_s[i].innerText.trim();
                for(let x = 0; x < hong_bo.length; x++){
                    if(text == hong_bo[x]){
                        // console.log('-----111111----------')
                        $span_s[i].classList.add('hong_bo');
                    }
                }
                for(let x = 0; x < lan_bo.length; x++){
                    if(text == lan_bo[x]){
                        // console.log('-----22222----------')
                        $span_s[i].classList.add('lan_bo');
                    }
                }
                for(let x = 0; x < lv_bo.length; x++){
                    if(text == lv_bo[x]){
                        // console.log('-----3333333----------')
                        $span_s[i].classList.add('lv_bo');
                    }
                }

            }
        },
  },
  mounted(){
    this.loading2 = true;
    this.getData();
    // var that = this;
    // setInterval(function(){
    //     that.getData();
    // },8000)
  },
  filters: {
    transImg: function(val) {
      var imgUrl1 = require("../../image/ks@1.png");
      var imgUrl2 = require("../../image/ks@2.png");
      var imgUrl3 = require("../../image/ks@3.png");
      var imgUrl4 = require("../../image/ks@4.png");
      var imgUrl5 = require("../../image/ks@5.png");
      var imgUrl6 = require("../../image/ks@6.png");
      if (val == 1) {
        val = imgUrl1;
      } else if (val == 2) {
        val = imgUrl2;
      } else if (val == 3) {
        val = imgUrl3;
      } else if (val == 4) {
        val = imgUrl4;
      } else if (val == 5) {
        val = imgUrl5;
      } else if (val == 6) {
        val = imgUrl6;
      }
      return val;
    }
  }
}
</script>

<style scoped>

.lottery_wrap{
    width:100%;
    background : #f2f2f2;
}

.lottery_cont{
    width:1200px;
    margin:0 auto;
}

.lottery_cont>h3{
    padding:20px 0 10px 0;
    color: #000;
    font-size:17px;
    border-bottom:1.5px solid #fff;
}

.lottery_cont>h3>span{
    color : #0047aa;
    cursor:pointer;
    font-size:16px;
    margin-right:20px;
}
.lottery_cont>h3>span::before{
    content:"";
    display:inline-block;
    width:15px;
    height:15px;
    background:url('../../image/zuo_jian_tou.png') no-repeat center / cover;
    vertical-align:middle;
    margin-top:-3px;
    margin-right:-3px;
}

.lottery_cont>h3>i{
    font-style:normal;
}
/* 内容表格部分 */
.lottery_cont>table{
    width:100%;
    padding-top:20px;
    border-collapse:collapse;
}
    /* 表头 */
.lottery_cont>table>thead>tr{
    display: flex;
    padding : 0 10px;
    margin-bottom:15px;
    margin-top:20px;
}
.lottery_cont>table>thead>tr>th{
    color:#545454;
    font-size:17px;
    font-weight:normal;
}
.lottery_cont>table>thead>tr>th:nth-child(1), .lottery_cont>table>tbody>tr>td:nth-child(1){
    text-align : left;
    flex: 1;
}
.lottery_cont>table>thead>tr>th:nth-child(2), .lottery_cont>table>tbody>tr>td:nth-child(2){
    text-align : left;
    flex: 1;
}
.lottery_cont>table>thead>tr>th:nth-child(3), .lottery_cont>table>tbody>tr>td:nth-child(3){
    text-align : left;
    flex: 2.5;
}
.lottery_cont>table>thead>tr>th:nth-child(4), .lottery_cont>table>tbody>tr>td:nth-child(4){
    text-align : right;
    flex: 1;
}

    /* 表身体 */
 .lottery_cont>table>tbody>tr{
     margin-bottom:15px;
     height:36px;
     padding : 2px 10px;
     line-height:36px;
     border-radius : 10px;
 }

 .lottery_cont>table>tbody>tr:last-child{
      box-shadow: 2px 3px 3px rgba(0,0,0,.2);
 }
 /* .lottery_cont>table>tbody>tr:hover td{
     color : #0047aa;
 } */
.lottery_cont>table>tbody>tr{
    background : #fff;
    display:flex;
}

.lottery_cont>table>tbody>tr>td div img{
    width:28px;
    height:28px;
    margin-top:3px;
}

.lottery_cont>table>tbody>tr>td{
    font-weight:normal;
    font-size:15px;
    color: #545454;
    line-height: 32px;
    /* cursor : pointer; */
}

.lottery_cont>table>tbody>tr>td span{
    display: inline-block;
    width:24px;
    height: 24px;
    background: #d50000;
    color : #fff;
    border-radius : 50%;
    text-align : center;
    line-height : 24px;
}

  /* 开奖加载图标 */
  .loading_kaijiang>strong{
    font-weight: normal;
}
  .loading_kaijiang{
      width:100%;
      height: 100%;
  }
  .loading_kaijiang>i{
      display: inline-block;
      width: 50px;
      height: 20px;
  }

  .loading_kaijiang>i>i{

      display: inline-block;
      width: 2px;
      height: 2px;
      background: #aaa;
  }

  .loading_kaijiang>i>i.active{
      background: #feb505;
  }

  @keyframes load_move {
      
      0%{
          background: #aaa
      }
      100%{
          background: #feb505;
      }
  }
  
.loading_kaijiang>i>i:nth-child(1){
animation: load_move 1s 1s linear infinite;
}
.loading_kaijiang>i>i:nth-child(2){
animation: load_move 2s 2s linear infinite;
}
.loading_kaijiang>i>i:nth-child(3){
animation: load_move 3s 3s linear infinite;
}
.loading_kaijiang>i>i:nth-child(4){
animation: load_move 4s 4s linear infinite;
}
.loading_kaijiang>i>i:nth-child(5){
animation: load_move 5s 5s linear infinite;
}
.loading_kaijiang>i>i:nth-child(6){
animation: load_move 6s 6s linear infinite;
}


/* 开奖球波色 */
.lottery_cont>table>tbody>tr>td span.hong_bo{
    background:#df0000;
   /* background-image: linear-gradient(145deg,#feb505,#f26921 30%,#ef0000 60%,#d50000); */
}
.lottery_cont>table>tbody>tr>td span.lan_bo{
    background:#0047aa;
   /* background-image : linear-gradient(145deg, #4492ff, #1174ff 30%,#005cdd 60%, #0047aa); */
}
.lottery_cont>table>tbody>tr>td span.lv_bo{
    background:#187e00;
   /* background-image: linear-gradient(145deg, #27cb00, #22b100 30%, #1d9800 60%, #187e00); */
}


</style>
